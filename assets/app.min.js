!function(){"use strict";var e={de:{commands:"Befehle",searchLabel:"Suche",searchPlaceholder:"z.B. G28, home, temp, fan, M109...",hint:"Tipp: Klick auf eine Code-Zeile → Erklärung rechts. Enter springt zum besten Treffer.",explainTitle:"Erklärung",explainEmpty:"Klick auf eine Code-Zeile, um zu sehen, was sie tut.",noResults:"Keine Treffer. Versuch z.B. <code>home</code>, <code>temp</code>, <code>fan</code> oder <code>G28</code>.",requires:"Benötigt",promoTitle:"Hilfe bei Marlin / G-code nötig?",promoText:"Wenn du bei Firmware, Start-/End-Gcode, Kalibrierung oder Fehlersuche nicht weiterkommst: Wir helfen dir schnell und praxisnah.",promoCta:"3D Partner kontaktieren"},en:{commands:"Commands",searchLabel:"Search",searchPlaceholder:"e.g. G28, home, temp, fan, M109...",hint:"Tip: Click a code line → explanation (right). Press Enter to jump to best match.",explainTitle:"Explanation",explainEmpty:"Click a code line to see what it does.",noResults:"No results. Try <code>home</code>, <code>temp</code>, <code>fan</code> or <code>G28</code>.",requires:"Requires",promoTitle:"Need help with Marlin / G-code?",promoText:"If you’re stuck with firmware, start/end G-code, calibration, or troubleshooting: we can help quickly and practically.",promoCta:"Contact 3D Partner"}};function t(e,t){return Array.prototype.slice.call(e.querySelectorAll(t))}function r(e){return String(e).replace(/[&<>"']/g,function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[e]})}function n(e,t){if(!e)return"";if("string"==typeof e)return e;if(e[t])return e[t];if(e.de)return e.de;var r=Object.keys(e);return r.length?e[r[0]]:""}function i(e){return String(e||"").trim()}function a(e){var t=String(e||"").toUpperCase(),r=/^([A-Z])(\d+(?:\.\d+)?)$/.exec(t);if(!r)return t;var n=r[1],i=r[2].split("."),a=i[0].replace(/^0+/,"");if(""===a&&(a="0"),1===i.length)return n+a;var o=i[1].replace(/0+$/,"");return""===o?n+a:n+a+"."+o}function o(e,t){if(!e)return!1;var r=String(e).toUpperCase();return t?!!t[r]||!!t[a(r)]:/^[A-Z]\d+(?:\.\d+)?$/i.test(r)}function c(e,t){var r=function(e){var t=String(e),r=(t=t.replace(/\([^)]*\)/g,"")).indexOf(";");return-1!==r&&(t=t.slice(0,r)),t.trim()}(e);if(!r)return[];var n=r.split(/\s+/).filter(Boolean);if(!n.length)return[];var i=[],a=null,c=[];function l(){a&&(a.line=a.lineTokens.join(" "),i.push({line:a.line,tokens:a.tokens}),a=null)}function s(e,t){var r=e[0]?e[0].toUpperCase():"",n=e.slice(1);/^[A-Z]$/.test(r)&&(n.length>0?t.tokens.push({k:r,v:n}):t.tokens.push({k:r,v:""}))}for(var d=0;d<n.length;d+=1){var u=n[d];if(o(u,t)){if(l(),a={lineTokens:c.length?c.concat([u]):[u],tokens:[{k:"cmd",v:u}]},c.length){for(var f=0;f<c.length;f+=1)s(c[f],a);c=[]}}else a?(a.lineTokens.push(u),s(u,a)):c.push(u)}return l(),i}function l(e,t){return("de"===t?{A:"Zusatzachse",B:"Zusatzachse",C:"Zusatzachse",D:"Werkzeugradius-Kompensation / Durchmesser",E:"Extrusionslänge / Extruder",F:"Vorschub / Feedrate",G:"G-Befehl",H:"Werkzeuglängen-Offset / Heizer-Nummer",I:"Bogenmittelpunkt-Versatz",J:"Bogenmittelpunkt-Versatz",K:"Bogenmittelpunkt-Versatz",L:"Wiederholungen / Modus",M:"M-Befehl",N:"Zeilennummer",O:"Programm / Subroutine",P:"Zeit / Parameterwert",Q:"Schrittweite / Parameter",R:"Radius / Referenzwert",S:"Wert (z.B. Temperatur/Drehzahl)",T:"Werkzeug / Extruder",U:"Zusatzachse",V:"Zusatzachse",W:"Zusatzachse",X:"Position (X)",Y:"Position (Y)",Z:"Position (Z)"}:{A:"Additional axis",B:"Additional axis",C:"Additional axis",D:"Tool radius comp / Diameter",E:"Extrusion length / Extruder",F:"Feedrate",G:"G command",H:"Tool length offset / Heater number",I:"Arc center offset",J:"Arc center offset",K:"Arc center offset",L:"Repetitions / Mode",M:"M command",N:"Line number",O:"Program / Subroutine",P:"Time / Parameter value",Q:"Step / Parameter",R:"Radius / Reference value",S:"Value (e.g. temperature/speed)",T:"Tool / Extruder",U:"Additional axis",V:"Additional axis",W:"Additional axis",X:"Position (X)",Y:"Position (Y)",Z:"Position (Z)"})[e]||("de"===t?"Parameter ":"Param ")+e}function s(e,t){var r={};if(!e||!e.params||!Array.isArray(e.params))return r;for(var i=0;i<e.params.length;i+=1){var a=e.params[i];if(a&&a.key){var o=String(a.key).trim().toUpperCase(),c=n(a.desc,t);c&&(r[o]=c)}}return r}function d(e,t){var r=e.querySelector("#"+CSS.escape(t));if(!r)return!1;var n=e.getBoundingClientRect().top,i=r.getBoundingClientRect().top-n+e.scrollTop;return e.scrollTo({top:i,behavior:"smooth"}),!0}function u(e,t,i){var a=n(e.title,t)||e.label||"",o=n(e.desc,t)||"",c=a,l=e.examples||[],s="";if(l.length)for(var d=0;d<l.length;d+=1){var u=l[d],f="string"==typeof u?u:u.code||"";f&&(s+='<span class="gref__line" data-line="'+r(f)+'">'+r(f)+"</span>")}return'<article class="gref__card" id="'+r(e.id)+'" data-id="'+r(e.id)+'"><div class="gref__head"><div class="gref__cmd">'+r(e.code||e.id)+'</div><div class="gref__tag">'+r(c)+"</div></div>"+(o?'<p class="gref__desc">'+r(o)+"</p>":"")+function(e,t,n){if(!e.requires||!e.requires.length)return"";for(var i='<div class="gref__badges" aria-label="'+r(n.requires+":")+'">',a=0;a<e.requires.length;a+=1)i+='<span class="gref__badge">'+r(e.requires[a])+"</span>";return i+"</div>"}(e,0,i)+'<div class="gref__codeWrap"><button class="gref__copy" type="button">Copy</button><pre class="gref__code"><code>'+s+"</code></pre></div></article>"}function f(e,r,n){for(var i=t(e,"[data-i18n]"),a=0;a<i.length;a+=1){var o=i[a].getAttribute("data-i18n");n[o]&&(i[a].textContent=n[o])}var c=e.querySelector("#gref-search");c&&c.setAttribute("placeholder",n.searchPlaceholder);var l=e.querySelector(".gref__tocTitle");l&&(l.textContent=n.commands);var s=e.querySelector(".gref__drawerTitle");s&&(s.textContent=n.commands)}function g(e,r){for(var n=t(e,".gref__langBtn"),i=0;i<n.length;i+=1)n[i].classList.toggle("is-active",n[i].getAttribute("data-lang")===r)}function m(){var o=document.getElementById("gref-root");if(o){var m=document.getElementById("gref-status"),v=window.GCodeRefConfig||{},h=v.jsonUrl,p=v.fallbackJsonUrl||"";if(h){var _=v.ui&&v.ui.defaultLang?v.ui.defaultLang:"de",y=function(){try{return localStorage.getItem("gref_lang")||""}catch(e){return""}}()||_;e[y]||(y=_);var b=e[y],x=o.querySelector(".gref__pane"),k=o.querySelector(".gref__resultsWrap"),E=document.getElementById("gref-toc"),C=document.getElementById("gref-toc-mobile"),L=document.getElementById("gref-results"),S=document.getElementById("gref-explain"),w=document.getElementById("gref-search"),A=o.querySelector(".gref__clear"),T=o.querySelector(".gref__tocBtn"),B=document.getElementById("gref-drawer"),P=document.getElementById("gref-backdrop"),I=o.querySelector(".gref__drawerClose");if(x&&k&&E&&L&&S&&w&&A){f(o,0,b),g(o,y),w.setAttribute("placeholder",b.searchPlaceholder),S.textContent=b.explainEmpty,T&&B&&P&&I&&(T.addEventListener("click",function(){"true"===T.getAttribute("aria-expanded")?j():T&&B&&P&&(T.setAttribute("aria-expanded","true"),B.hidden=!1,P.hidden=!1,requestAnimationFrame(function(){B.classList.add("is-open")}))}),I.addEventListener("click",j),P.addEventListener("click",j),document.addEventListener("keydown",function(e){"Escape"===e.key&&"true"===T.getAttribute("aria-expanded")&&j()}));var q,z,M,R,Z,G=[],O={},U={},F=null,H=null,W=(q=function(){J(w.value,!1),A.style.visibility=i(w.value)?"visible":"hidden"},z=100,M=null,function(){var e=arguments;clearTimeout(M),M=setTimeout(function(){q.apply(null,e)},z)});E.addEventListener("click",X),C&&C.addEventListener("click",X),E.addEventListener("keydown",function(e){if("Enter"===e.key||" "===e.key){var t=e.target.closest(".gref__tocItem");if(t){e.preventDefault();var r=t.getAttribute("data-id");r&&(d(k,r),K(r,!0))}}}),L.addEventListener("click",function(e){var n=e.target.closest(".gref__copy");if(n){var i=n.closest(".gref__card"),o=i?i.querySelector("pre.gref__code code"):null,d=o?o.innerText.replace(/\n{2,}/g,"\n"):"",u=function(){var e=n.textContent;n.textContent="Copied ✓",setTimeout(function(){n.textContent=e},900)};if(navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText(d).then(u).catch(function(){var e=document.createElement("textarea");e.value=d,document.body.appendChild(e),e.select(),document.execCommand("copy"),e.remove(),u()});else{var f=document.createElement("textarea");f.value=d,document.body.appendChild(f),f.select(),document.execCommand("copy"),f.remove(),u()}}else{var g=e.target.closest(".gref__line");g&&(t(L,".gref__line--active").forEach(function(e){e.classList.remove("gref__line--active")}),g.classList.add("gref__line--active"),S.innerHTML=function(e,t,n,i){for(var o=String(e||"").split(/\r?\n/),d=[],u=0;u<o.length;u+=1){var f=c(o[u],i);f.length&&(d=d.concat(f))}if(!d.length)return"<div>No data.</div>";for(var g="",m=0;m<d.length;m+=1){var v=d[m].tokens,h=v[0].v||"",p=String(h).toUpperCase(),_=n?n[p]:null;!_&&n&&(_=n[a(p)]||null);var y=s(_,t),b=v.slice(1);if(g+='<div class="gref__exSection">',g+="<div><strong>"+("de"===t?"Zeile":"Line")+":</strong> <code>"+r(d[m].line)+"</code></div>",g+='<div class="gref__kv"><div><strong>'+("de"===t?"Befehl":"Command")+":</strong> <code>"+r(h)+"</code></div>",b.length){g+='<div style="margin-top:6px;"><strong>'+("de"===t?"Parameter":"Parameters")+":</strong></div>",g+='<ul style="margin:6px 0 0 18px;">';for(var x=0;x<b.length;x+=1){var k=b[x],E=y[k.k]||"";g+="<li>"+(E?k.k+" – "+E:k.k+" – "+l(k.k,t))+": <code>"+r(""===k.v?"de"===t?"gesetzt":"set":k.v)+"</code></li>"}g+="</ul>"}else g+='<div style="margin-top:6px;">'+("de"===t?"Keine Parameter.":"No parameters.")+"</div>";g+="</div></div>"}return g}(g.getAttribute("data-line")||"",y,O,U))}}),w.addEventListener("input",W),w.addEventListener("keydown",function(e){"Enter"===e.key&&(e.preventDefault(),J(w.value,!0))}),A.addEventListener("click",function(){w.value="",A.style.visibility="hidden",V([]),S.textContent=e[y].explainEmpty,w.focus()}),A.style.visibility="hidden",t(o,".gref__langBtn").forEach(function(t){t.addEventListener("click",function(){var r=t.getAttribute("data-lang");r&&e[r]&&(function(e){try{localStorage.setItem("gref_lang",e)}catch(e){}}(y=r),N())})}),m&&(m.textContent=""),(R=h,Z=p,D(R).catch(function(e){if(Z&&Z!==R)return D(Z);throw e})).then(function(e){if(!e||!e.commands||!Array.isArray(e.commands))throw new Error("Invalid JSON schema. Expected { meta, commands: [] }");G=(G=e.commands.slice()).filter(function(e){return e&&e.id&&e.code}),function(){for(var e=0;e<G.length;e+=1){var t=G[e],r="";t.title&&("string"==typeof t.title?r+=" "+t.title:r+=" "+(t.title.de||"")+" "+(t.title.en||"")),t.desc&&("string"==typeof t.desc?r+=" "+t.desc:r+=" "+(t.desc.de||"")+" "+(t.desc.en||"")),t.aliases&&t.aliases.length&&(r+=" "+t.aliases.join(" ")),t.category&&(r+=" "+t.category),t._search=r.trim()}}(),window.Fuse&&G.length&&(F=new window.Fuse(G,{keys:[{name:"id",weight:.1},{name:"code",weight:.45},{name:"_search",weight:.45}],threshold:.35,ignoreLocation:!0,minMatchCharLength:2})),function(){O={},U={};for(var e=0;e<G.length;e+=1){var t=G[e];if(t&&t.code){var r=String(t.code).toUpperCase(),n=a(r);O[r]=t,O[n]=t,U[r]=!0,U[n]=!0}}}(),f(o,0,b),g(o,y),w.setAttribute("placeholder",b.searchPlaceholder),S.textContent=b.explainEmpty,N(),function(){if("IntersectionObserver"in window){var e=t(L,".gref__card");if(e.length)for(var r=new IntersectionObserver(function(e){var t=e.filter(function(e){return e.isIntersecting}).sort(function(e,t){return e.boundingClientRect.top-t.boundingClientRect.top});if(t.length){var r=t[0].target.getAttribute("data-id");r&&r!==H&&K(r,!0)}},{root:k,threshold:[.15,.3,.6]}),n=0;n<e.length;n+=1)r.observe(e[n])}}();var r=decodeURIComponent((location.hash||"").replace(/^#/,""));r&&(d(k,r)&&(K(r,!0),V([r])))}).catch(function(e){if(m){var t=p&&p!==h?h+" | "+p:h;m.textContent="Failed to load JSON from: "+t+". "+(e&&e.message?e.message:String(e))}L.innerHTML='<div class="gref__empty">Failed to load commands.json.</div>'})}}else m&&(m.textContent="GCodeRefConfig.jsonUrl missing.")}function j(){T&&B&&P&&(T.setAttribute("aria-expanded","false"),B.classList.remove("is-open"),setTimeout(function(){B.hidden=!0,P.hidden=!0},200))}function D(e){return fetch(e,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw new Error("JSON fetch failed: "+e.status);return e.json()})}function N(){f(o,0,b=e[y]),g(o,y),E.innerHTML=G.map(function(e){return function(e,t){var i=n(e.title,t)||e.label||"";return'<div class="gref__tocItem" role="button" tabindex="0" data-id="'+r(e.id)+'"><div class="gref__tocCode">'+r(e.code||e.id)+'</div><div class="gref__tocLabel">'+r(i)+"</div></div>"}(e,y)}).join(""),C&&(C.innerHTML=E.innerHTML),L.innerHTML=G.map(function(e){return u(e,y,b)}).join("");var t=G[0]?G[0].id:null;t&&K(t,!1),J(w.value,!1)}function K(e,r){e&&(H=e,[E,C].forEach(function(r){if(r){t(r,".gref__tocItem.is-active").forEach(function(e){e.classList.remove("is-active")});var n=r.querySelector('.gref__tocItem[data-id="'+CSS.escape(e)+'"]');n&&n.classList.add("is-active")}}),r&&function(e){try{history.replaceState(null,"","#"+encodeURIComponent(e))}catch(e){}}(e))}function V(e){var r=new Set(e);[E,C].forEach(function(e){e&&t(e,".gref__tocItem").forEach(function(e){var t=e.getAttribute("data-id");e.classList.toggle("is-match",r.has(t))})}),t(L,".gref__card").forEach(function(e){var t=e.getAttribute("data-id");e.classList.toggle("is-match",r.has(t))})}function J(e,t){var r=i(e);if(r){var n=function(e){if(!e)return[];if(F)return F.search(e).map(function(e){return e.item.id});for(var t=e.toLowerCase(),r=[],n=0;n<G.length;n+=1){var i=G[n];-1!==(i._search||"").toLowerCase().indexOf(t)&&r.push(i.id)}return r}(r);if(V(n),t){var a=n.length?n[0]:function(e){if(!e)return null;if(F){var t=F.search(e);return t[0]?t[0].item.id:null}for(var r=e.toLowerCase(),n=0;n<G.length;n+=1){var i=G[n];if(-1!==(i._search||"").toLowerCase().indexOf(r))return i.id}return null}(r);a&&(d(k,a),K(a,!0))}}else V([])}function X(e){var t=e.target.closest(".gref__tocItem");if(t){var r=t.getAttribute("data-id");r&&(d(k,r),K(r,!0),T&&"true"===T.getAttribute("aria-expanded")&&j())}}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",m):m()}();